<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Grails Workshop</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Include the appropriate print stylesheet -->
    <!--<script>-->
        <!--var link = document.createElement( 'link' );-->
        <!--link.rel = 'stylesheet';-->
        <!--link.type = 'text/css';-->
        <!--link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';-->
        <!--document.getElementsByTagName( 'head' )[0].appendChild( link );-->
    <!--</script>-->

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">

        <section data-background="images/presentation-16-9-pages2.png">
            <h1>Grails</h1>

            <h3>N00B to ninja in 3 hours</h3>

            <p>
                <small><a href="http://brianjohnsen.dk">Brian Johnsen</a> / <a href="http://twitter.com/brianjohnsendk">@brianjohnsendk</a></small>
            </p>
        </section>


        <!------------------------------------------------------->
        <!---- WHOAMI ------------------------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <h2>Whoami</h2>
            <p><small>(whocares)</small></p>
            <ul>
                <li>Brian Johnsen, Gennemtænkt IT A/S</li>
                <li>12+ years Java</li>
                <li>Groovy & Grails since 2008</li>
                <li>Your Friendly Neighborhood GR8Conf Organizer</li>
            </ul>
        </section>


        <!--NOTES:-->
        <!--1. brug fragments til at vise progress i en side (fx. løb gennem punkter)-->
        <!--2. presentation mode i IDEA-->

        <!------------------------------------------------------->
        <!---- AGENDA ------------------------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <h2>Agenda</h2>
            <p><small>fire up the engines</small></p>
            <ol>
                <li>Install grails</li>
                <li>Domain</li>
                <li>...</li>
            </ol>
        </section>


        <!------------------------------------------------------->
        <!---- INSTALL ------------------------------------------>
        <!------------------------------------------------------->
        <section>
            <section data-background="images/presentation-16-9-pages2.png">

                <h2>Ready?</h2>
                <ol>
                    <li>Copy grails install to disk and unzip</li>
                    <li>Add to path</li>
                    <li>Voilá</li>
                </ol>
                <br/>
                <br/>
                <pre><code data-trim>
$ grails -version
Grails version: 2.3.8
                </code></pre>

            </section>
        </section>


        <!------------------------------------------------------->
        <!---- FRAMEWORK & ARCHITECTURE ------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Full stack framework</h2>
                <ul>
                    <li>ORM (GORM)                                              </li>
                    <li>Powerful view technology (GSP) and easy TagLib creation </li>
                    <li>Dependency Injection and on-the-fly reloading (Spring)  </li>
                    <li>Internationalization support (i18n)                     </li>
                    <li>Runtime Container (Tomcat)                              </li>
                    <li>Testing Framework (Spock)                               </li>
                    <li>Plugin System                                           </li>
                    <li>Command line tools                                      </li>
                    <li>Build Tool (Gant/Gradle)                                </li>
                    <li>and a bunch of other stuff…                             </li>
                </ul>
            </section>

            <section>
                <h2>Architecture</h2>
                <img src="images/grailsstack.png" />
            </section>

            <section>
                <h2>Philosophy</h2>
                <img src="images/convention.jpg" />
            </section>
        </section>



        <!------------------------------------------------------->
        <!---- CREATE THE APP ----------------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <h2>Lets get started!</h2>
        </section>

        <!------------------------------------------------------->
        <!---- CREATE THE APP ----------------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Demo time!</h2>
                <img src="images/hammertime.jpg" />
                <p>CLI and create app demo</p>
            </section>

            <section>
                <h2>Your turn!</h2>
                <img src="images/work.jpeg" />
            </section>


            <section>
                <h2>CLI</h2>

                <p>Try it out</p>
                <pre><code data-trim>
    $ grails help
                </code></pre>
                It just goes on...
            </section>

            <section>
                <h2>Create the app</h2>

                <pre><code data-trim>
    $ grails create-app grailsdemo
                </code></pre>
                <pre><code data-trim>
    $ cd grailsdemo
                </code></pre>
                <pre><code data-trim>
    $ grails run-app
                </code></pre>

                <br>
                <pre><code data-trim>
                    | Server running. Browse to http://localhost:8080/grailsdemo
                </code></pre>
                <small>Open your favorite browser and check it out!</small>
            </section>

            <section>
                <h2>Running application!</h2>
                <img src="images/grails-startpage.png" />
            </section>

        </section>


        <!------------------------------------------------------->
        <!---- ANATOMY ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Anatomy</h2>
                <img src="images/anatomi.png" />
            </section>
            <section>
                <h2>Anatomy</h2>
                <small>
                    <ul>
                        <li><code>grails-app</code> - Top level directory for Groovy sources</li>
                        <ul>
                            <li><code>conf</code> - Configuration sources.</li>
                            <li><code>controllers</code> - Web controllers - The C in MVC.</li>
                            <li><code>domain</code> - The application domain - The M in MVC.</li>
                            <li><code>i18n</code> - Support for internationalization (i18n).</li>
                            <li><code>migrations</code> - Database migration.</li>
                            <li><code>services</code> - The service layer.</li>
                            <li><code>taglib</code> - Tag libraries.</li>
                            <li><code>utils</code> - Grails specific utilities.</li>
                            <li><code>views</code> - Groovy Server Pages - The V in MVC.</li>
                        </ul>
                        <li><code>scripts</code> - Gant scripts.</li>
                        <li><code>src</code> - Supporting sources</li>
                        <ul>
                            <li><code>groovy</code> - Other Groovy sources</li>
                            <li><code>java</code> - Other Java sources</li>
                        </ul>
                        <li><code>test</code> - Unit and integration tests.</li>
                        <li><code>web-app</code> - JavaScript and CSS.</li>
                        <li><code>wrapper</code> - Wrapper.</li>
                    </ul>
                </small>

            </section>
        </section>


        <!------------------------------------------------------->
        <!---- NO FORK! ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <img src="images/stop.gif" />
            </section>

            <section>
                <img src="images/panik.jpg" />
            </section>

            <section>
                <h2>Don't let friends fork</h2>
                <p>Open:</p>
                <pre><code data-trim>/grails-app/conf/BuildConfig.groovy</code></pre>
                <p>Change:</p>
                <pre><code data-trim>
grails.project.fork = [
    // configure settings for compilation JVM, note that if you alter the Groovy version forked compilation is required
    ...
    ...
    // configure settings for the Console UI JVM
    console: [maxMemory: 768, minMemory: 64, debug: false, maxPerm: 256]
]
                </code></pre>
                <p>To:</p>
                <pre><code data-trim>
grails.project.fork = false
                </code></pre>

            </section>
        </section>


        <!------------------------------------------------------->
        <!---- DOMAIN MODEL ------------------------------------->
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Domain</h2>
                <p><code>/grails-app/domain/</code></p>
                <br/>
                <ul>
                    <li>The M in MVC</li>
                    <li>Gets mapped to the database</li>
                    <li>Dynamic finders FTW -> Forget SQL</li>
                    <li><code>constraints</code> enforce database consistency</li>
                    <li>Defines scaffolded views</li>
                </ul>
            </section>

            <section>
                <h2>Domain demo!</h2>
                <img src="images/hammertime.jpg" />
            </section>

            <section>
                <h2>My first domain class</h2>
<pre><code data-trim>
    $ grails create-domain-class Person
</code></pre>

<pre><code data-trim>
//grails-app/domain/Person.groovy
class Person {
    String name
    Integer age
    static constraints = {
        name blank: false
    	age min: 0
    }
}
</code></pre>
            </section>

            <section>
                <h2>Save and validate</h2>
                <p>
                    <code>constraints</code> are enforced on <code>save()</code> and <code>validate()</code>
                </p>
<pre><code data-trim>
def person = new Person(age: 42, name: 'Douglas Adams')

person.validate() //only checks constraints
person.save() //saves the instance to the database
</code></pre>
            </section>

            <section>
                <h2>whole lotta dynamic goin’ on</h2>
                <p>Finders are dynamically created for all properties</p>
<pre><code data-trim>
def everybody = Person.list()
def theOne = Person.findByNameAndAge('Brian', 41)
def caseInsensitive = Person.findAllByNameIlike('graeme')
def underAge = Person.findAllByAgeLessThan(18)
def seniors = Person.findAllByAgeGreaterThanEquals(65)
def orderedByName = Person.listOrderByName()
</code></pre>
            </section>

        </section>



        <!------------------------------------------------------->
        <!---- TESTING ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Testing</h2>
                <p><code>/test/unit/</code></p>
                <br/>
                <ul>
                    <li>Spock Specifications</li>
                    <li>Deeply integrated in Grails</li>
                    <li>When creating any artifact a corresponding test is created</li>
                    <ul><li>Creating <code>Person</code> also creates a <code>PersonSpec</code></li></ul>
                </ul>
            </section>

            <section>
                <h2>Test demo!</h2>
                <img src="images/hammertime.jpg" />
            </section>

            <section>
                <h2>Spock test default</h2>
<pre><code data-trim>
    //test/unit/grailsdemo/PersonSpec.groovy
@TestFor(Person)
class PersonSpec extends Specification {
    def setup() {
    }

    def cleanup() {
    }

    void "test something"() {
    }
}
</code></pre>
            </section>


            <section>
                <h2>Write a test!</h2>
                <img src="images/work.jpeg" />
                <p>"age should be more than 0"</p>
            </section>


            <section>
                <h2>Could look like this</h2>
<pre><code data-trim>
    //test/unit/grailsdemo/PersonSpec.groovy
@TestFor(Person)
class PersonSpec extends Specification {
    void "age should be more than 0"() {
    	when:
    	def person = new Person(age: age, name: 'joe')

    	then:
    	person.validate() == valid

    	where:
    	age	| valid
    	0	| true
    	41	| true
    	-1	| false
    }
}
</code></pre>
            </section>


            <section>
                <h2>Testing</h2>
                <h3> - The easiest way to execute code!</h3>
                <img src="images/children-playing.jpg" />
                <p>Play with dynamic finders</p>
            </section>




        </section>


        <!------------------------------------------------------->
        <!---- CONTROLLERS ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Taking control</h2>
                <p><code>/grails-app/controllers/</code></p>
                <br/>
                <ul>
                    <li>The C in MVC</li>
                    <li>Data binding</li>
                    <li>Redirecting requests</li>
                    <li>Delegating to business logic</li>
                </ul>
            </section>

            <section>
                <h2>Him again!</h2>
                <img src="images/hammertime.jpg" />
                <p>Scaffolded UI Demo</p>
            </section>

            <section>
                <h2>Scaffolded controller</h2>
<pre><code data-trim>
//grails-app/controllers/grailsdemo/PersonController.groovy
class PersonController {
    static scaffold = true
}
</code></pre>
                <p>Fire it up and give it a spin</p>
                <p><pre><code data-trim>$ grails run-app</code></pre></p>
            </section>


            <section>
                <h2>Stop the presses</h2>
                <h3>It's backed by a real database!</h3>
                <p>Browse to http://localhost:8080/demo/dbconsole</p>
                <img src="images/dbconsole.png" />
            </section>


            <section>
                <h2>Want some REST?</h2>
            </section>

            <section>
                <h2>Automatic Content Negotiation</h2>
                <p>http://localhost:8080/demo/person/show/1.json</p>
                <pre><code data-trim>
{
    class: "grailsdemo.Person",
    id: 1,
    age: 41,
    name: "Brian"
}
                </code></pre>

                <br/>
                <p>http://localhost:8080/demo/person/show/1.xml</p>
                <pre><code data-trim>
<person id="1">
    <age>41</age>
    <name>Brian</name>
</person>
                </code></pre>
            </section>


            <section>
                <h2>Back on track</h2>
                <img src="images/backontrack.jpg" />
            </section>


            <section>
                <h2>Generate controller</h2>
                <img src="images/work.jpeg" />
                <p><pre><code data-trim>$ grails generate-controller grailsdemo.Person</code></pre></p>
            </section>

            <section>
                <h2>All that code</h2>
                <p>Open:</p>
                <pre><code data-trim>grails-app/controllers/grailsdemo/PersonController.groovy</code></pre>
            </section>


            <section>
                <h2>Something like this?</h2>
                <pre><code data-trim>
//grails-app/controllers/grailsdemo/PersonController.groovy
@Transactional(readOnly = true)
class PersonController {

    static allowedMethods = [save: "POST", update: "PUT", delete: "DELETE"]

    def index(Integer max) {
        params.max = Math.min(max ?: 10, 100)
        respond Person.list(params), model: [personInstanceCount: Person.count()]
    }

    def show(Person personInstance) {
        respond personInstance
    }
    ...
    ...
}
                </code></pre>
            </section>


            <section>
                <h2>Testing controllers</h2>
                <p>Run:</p>
                <pre><code data-trim>
                    $ grails test-app unit: PersonController
                </code></pre>
                <p>What happens?</p>
                <br/>
                <p>Open:</p>
                <pre><code data-trim>/test/unit/grailsdemo/PersonControllerSpec.groovy</code></pre>
            </section>

            <section>
                <h2>Testing controllers</h2>
                <p>Change:</p>
                <pre><code data-trim>
    def populateValidParams(params) {
        assert params != null
        // TODO: Populate valid properties like...
        //params["name"] = 'someValidName'
    }
                </code></pre>
                <p>To:</p>
                <pre><code data-trim>
    def populateValidParams(params) {
        assert params != null
        params["name"] = 'joe' //or whatever
        params["age"] = 42 //or whatever
    }                </code></pre>
            </section>


            <section>
                <h2>More Testing</h2>
                <img src="images/children-playing.jpg" />
                <p>Do we have the time?</p>
            </section>


        </section>




        <!------------------------------------------------------->
        <!---- VIEW ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Views</h2>
                <p><code>/grails-app/views/</code></p>
                <br/>
                <ul>
                    <li>The V in MVC</li>
                    <li>GSP</li>
                </ul>
            </section>

            <section>
                <h2>Generate views</h2>
                <img src="images/work.jpeg" />
                <p><pre><code data-trim>$ grails generate-all grailsdemo.Person</code></pre></p>
            </section>

            <section>
                <h2>The index view</h2>
                <p>Open:</p>
                <pre><code data-trim>grails-app/views/person/index.gsp</code></pre>
            </section>

            <section>
                <h2>The show view</h2>
                <p>Open:</p>
                <pre><code data-trim>grails-app/views/person/show.gsp</code></pre>
            </section>

            <section>
                <h2>Create and edit views - templates</h2>
                <p>Open:</p>
                <pre><code data-trim>grails-app/views/person/create.gsp</code></pre>
                <pre><code data-trim>grails-app/views/person/edit.gsp</code></pre>
                <pre><code data-trim>grails-app/views/person/_form.gsp</code></pre>
            </section>

        </section>



        <!------------------------------------------------------->
        <!---- SERVICES ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Services</h2>
                <p><code>/grails-app/services/</code></p>
                <br/>
                <ul>
                    <li>Should contain all business logic</li>
                    <li>Transactional</li>
                    <li>Injected into any artefact</li>
                </ul>
            </section>

            <section>
                <h2>Create the service</h2>
                <img src="images/work.jpeg" />
                <p><pre><code data-trim>$ grails create-service Person</code></pre></p>

                <p>Open:</p>
                <pre><code data-trim>grails-app/services/demo/PersonService.groovy</code></pre>
            </section>

            <section>
                <h2>Update the service</h2>
                <p><pre><code data-trim>
@Transactional
class PersonService {
    def getAll() {
        Person.list()
    }
}

                </code></pre></p>
            </section>

            <section>
                <h2>Update the controller</h2>
                <p><pre><code data-trim>
class PersonController {

    PersonService personService //injected by grails

    def index(Integer max) {
        respond personService.getAll()
    }
...
}
                </code></pre></p>
            </section>

        </section>



        <!------------------------------------------------------->
        <!---- UPDATE APP ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <section>
                <h2>Lets add a new feature</h2>
                <p>Person should have country</p>
<pre><code data-trim>
//grails-app/domain/Person.groovy
class Person {
    String name
    Integer age
    String country
    static constraints = {
        name blank: false
    	age min: 0
        country nullable: true
    }
}
</code></pre>
            </section>

            <section>
                <h2>Update the tests</h2>
                <img src="images/work.jpeg" />
                <p>Open:</p>
                <pre><code data-trim>test/unit/grailsdemo/PersonSpec.groovy</code></pre>
            </section>

            <section>
                <h2>Update the view</h2>
                <p>Open:</p>
                <pre><code data-trim>grails-app/views/person/index.gsp</code></pre>
                <p>and:</p>
                <pre><code data-trim>grails-app/views/person/_form.gsp</code></pre>
            </section>


            <section>
                <h2>Another new feature</h2>
                <p>Creating a new person should send you to the list view (index)</p>
                <p>Open:</p>
                <pre><code data-trim>grails-app/controllers/grailsdemo/PersonController.groovy</code></pre>
            </section>


        </section>


        <!------------------------------------------------------->
        <!---- PLUGINS ------------------------------------------>
        <!------------------------------------------------------->
        <section data-background="images/presentation-16-9-pages2.png">
            <h2>Plugins</h2>
            <p><code>https://grails.org/plugins/</code></p>
            <br/>
            <ul>
                <li>Build Test Data</li>
                <li>Searchable</li>
                <li>Quartz</li>
                <li>Spring Security</li>
                <li>MongoDB</li>
                <li>and it goes on and on...</li>
            </ul>
        </section>


    </div>
</div>








<!------------------------------------------------------->
<!---- REVEAL STUFF ------------------------------------->
<!------------------------------------------------------->

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        // theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        // transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // // Parallax scrolling
        // // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // // parallaxBackgroundSize: '2100px 900px',

        // // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
            { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]    });

</script>

</body>
</html>
